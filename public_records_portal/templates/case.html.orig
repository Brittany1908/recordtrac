<!-- This template houses the baseline case information (request, documents, status, etc.) only. -->

{% extends "base.html" %}
<<<<<<< HEAD
{% block title %}Request{% endblock %}

{% block content %}
  {% block well %}
  <div id="request-container" class="row-fluid">
    <div class="span9 well">

      {% block request %}
        <!-- request area -->
        <div class="row-fluid">
          <h3 >Request <span class="muted">#{{req.id}}</span></h3>
          <div class="span10">
            <p class="lead" truncateable="150"> {{ req.text | new_lines }} </p>
          </div>
=======
{% block title %}Request{% endblock title %}


{% block container %}
  <div class="row-fluid">
    <div class="span9">
      {% block banner %}{{super()}}{% endblock banner %}
    </div>
  </div>
  <div class="row-fluid">
    <div class="span8 offset1">
      {% block well %}
        <div class="well">

          {% block request %}
            <!-- request area -->
            <div class="row-fluid">
              <h3 >Request <span class="muted">#{{req.id}}</span></h3>
               {% block clarify_request %}{% endblock clarify_request %}
              <p class="lead" truncateable="250"> {{ req.text | new_lines }} </p>
            </div>
            <div class="row-fluid">
              {% block proxyrequester_info %}
                <small>
                  {% if req.creator_id %}
                    <span>This request was submitted on behalf of the requester by {{ "alias"| get_attribute(req.creator_id, "User") }}.</span>
                  {% endif %}
                </small>
              {% endblock proxyrequester_info %}
            </div>
            <div class="row-fluid">
              {% block public_note %}{% endblock public_note %}
            </div>
            <div>
            <!-- shows any existing Q&A or public notes -->
            {% set request_data = ( req | get_request_data_chronologically ) %}
              {% for response in request_data %}
                {% set icon = response.get_icon() %}
                <div class="row-fluid response">
                  <div class="span1 text-left">
                    <i class="{{icon}}"></i>
                  </div>
                  <div class="span9">
                    <p truncateable="175"> 
                     {{ response.display_text() | safe }} 
                   </p>
                  </div>
                  <div class="span2 text-right">
                    <div class="row-fluid">
                      <p>Requester</p>
                    </div>
                    <div class="row-fluid">
                      <span class="timestampPopover" onmouseover="timestampPopover('{{ response.date() | date_granular }}')">{{ response.date() | date_granular }}</span>
                      {% include '_timestamp.html' %}
                    </div>
                  </div>
                </div>
              {% endfor %}
              </div>
            
          {% endblock request %}
>>>>>>> 8ce037daba1a98982998fca89c20e5f60377921c
        </div>
      {% endblock well %}
      <div class="row-fluid">
        {% block requester_info %}{% endblock requester_info %}
      </div>
      {% block responses_container %}
        <div id="responses-container" class="row-fluid">
          <h3 class="response">Response</h3>{% block response_actions %}{% endblock response_actions %}
          <!-- shows all existing responses (links, documents, offline docs, notes) -->
          {% set responses = ( req | get_responses_chronologically ) %}
          {% if responses %} 
            {% for response in responses %}
              {% set uid = response.uid() %}
              {% set staff = ("User" | get_obj(uid)) %}
              {% set icon = response.get_icon() %}
              <div class="row-fluid response-wrapper">
                <div class="span1 text-left">
                  <i class="{{icon}}"></i>
                </div>
                <div class="span9">
                  <p truncateable="175"> 
                   {{ response.display_text() | safe }} 
                 </p>
                </div>
<<<<<<< HEAD
              </div>
            {% endif %}
          {% endfor %}
        {% endif %}

        <!-- shows any existing Q&A -->
        {% if req.qas %}
          {% block qas %}
          <div class="row-fluid">
            {% for qa in req.qas %}
              <div class="row-fluid response qa">
                <div class="span2 text-center">
                  <i class="icon-question icon-2x">  </i> </br>
                  <small> {{ qa.date_created | date_granular }}</small> </br>
                </div>
                <div class="span10">
                  {% set uid = qa.owner_id %}
                  {% set staff = (uid | get_staff) %}
                  <div class="qa-question" truncateable="250"> {{ qa.question }} - <em><a href="/staff_card/{{uid}}" data-placement="top" data-toggle="popover" href="#" id="contactinfoPopoverQA{{loop.index}}" class="hidden-phone hidden-tablet"><span class="contactinfoPopover" onmouseover="directoryPopover('{{staff.email}}', '{{staff.department}}', '{{staff.phone}}', '#contactinfoPopoverQA{{loop.index}}')">{{ staff.alias or staff.email }}</span></a></em></div>
                  {% if qa.answer %}
                    <div class="qa-answer"> {{ qa.answer }} - <em>{{qa.subscriber_id | user_name }}</em></div>
                    {% else %}
                    {% block answer %}{% endblock answer %}
                  {% endif %}
=======
                <div class="span2 text-right">
                  <div class="row-fluid">
                    <a href="/staff_card/{{uid}}" data-placement="right" data-toggle="popover" id="contactinfoPopoverResponse{{loop.index}}" class="hidden-phone hidden-tablet"><span class="contactinfoPopover" onmouseover="directoryPopover('{{staff.email}}', '{{staff.department}}', '{{staff.phone}}', '#contactinfoPopoverResponse{{loop.index}}')">{{ staff.alias or staff.email }}</span></a>
                  </div>
                  <div class="row-fluid">
                    <!-- <a data-placement="right" data-toggle="popover" href="#" id="timestampPopover" class="hidden-phone hidden-tablet"> -->
                      <span class="timestampPopover" onmouseover="timestampPopover('{{ response.date() | date_granular }}')">{{ response.date() | date_granular }}</span>
                    <!-- </a> -->
                    {% include '_timestamp.html' %}
                  </div>
>>>>>>> 8ce037daba1a98982998fca89c20e5f60377921c
                </div>
              </div>
            {% endfor %}
          {% else %}<!--added an if then to check to see if any responses exist - if no then show text here for the "if any response exists" above -->
            <div class="row-fluid">
              <p>There are no records uploaded just yet.  Stay tuned!</p>
            </div>
          {% endif %}
        </div>
      {% endblock responses_container %}
    </div>
    
    <div class="span3">
      {% block sidebar %}
        {% block status %}
        <div class="well well-small r_sidebar_banner r_sidebar-fixed hidden-phone hidden-tablet">
          <h4 class="text-center">Status</h4>
        </div>
        {% endblock status %}
        <div class="well well-small b_sidebar r_sidebar-fixed hidden-phone hidden-tablet">
          <div class="row-fluid">
              <h4>Point of Contact</h4>
              {% include '_contact_popover.html' %}
          </div>
          <div class="row-fluid">
              <h4>Helpers</h4>
              {% for owner in req.owners %}
              {% set staff = ( "User" | get_obj(owner.user_id)) %}
               {{ staff.alias }} </br>
              {% endfor %}
          </div>
          <div class="row-fluid">
            <div>
              {% include '_history.html' %}
            </div>
          </div>
        </div>
      {% endblock sidebar %}

<<<<<<< HEAD
      {% endif %}
      <div id="load-more-qa">
        Load More... (WORK IN PROGRESS)
      </div>
    </div>
  {% endblock well %}

  <div id="routed-to-container" class="span3" data-sticky="true">
    {% block status %}
    <div class="text-right">
      {% block routing %}
      {% set uid = (req.current_owner | owner_uid) %}
      {% set staff = (uid | get_staff) %}
      Routed to <a href="/staff_card/{{uid}}" data-placement="top" data-toggle="popover" href="#" id="contactinfoPopoverRoute"><span class="label label-info" onmouseover="directoryPopover('{{staff.email}}', '{{staff.department}}', '{{staff.phone}}', '#contactinfoPopoverRoute')">{{ staff.alias or staff.email }}</span></a>
      {% endblock routing %}
      {% block history %}
      <a data-placement="left" data-toggle="popover" href="#" class="historyPopover hidden-phone hidden-tablet"> <i class="icon-time" ></i>  </a>
      <div id="historyPopover-head" class="hide">Routing history</div>
      <div id="historyPopover-content" class="hide">
        <table class="table table-condensed">
          <thead>
            <tr>
              <th>Date</th>
              <th></th>
              <th>To</th>
              <th>Note</th>
            </tr>
          </thead>
          <tbody>
            <!-- the order of data returned here should be reverse chronological (right now it's shown as oldest first)-->
            {% for owner in req.owners %}
            <tr>
              <td>{{ owner.date_created | date }}</td>
              <td><i class="icon-circle-arrow-right"></i></td>
              <td>{{ owner.user_id | get_staff_info("name") }}</td>
              <td>{{ owner.reason }}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
      {% endblock history %}
    </div>
    {% endblock status %}
=======
      {% block request_dates %}
        <div class="muted text-center">Created: {{ req.date_created | date }}</div>
      {% endblock request_dates %}
    </div>
    
>>>>>>> 8ce037daba1a98982998fca89c20e5f60377921c
  </div>

{% endblock container %}







<<<<<<< HEAD
{% block responses_container %}
<div id="responses-container" class="row-fluid">
  <div class="span9">
  <h3 class="response">Response</h3>
  <!-- shows all existing responses (links, documents, offline docs, notes) -->
  {% set responses = ( req | get_responses_chronologically ) %}
  {% if responses %}
    {% for response in responses %}
      {% set uid = response.uid() %}
      {% set staff = (uid | get_staff) %}
      {% set icon = response.get_icon() %}
      <div class="row-fluid response-wrapper">
        <div class="span2 text-center">
          <i class="{{icon}}">  </i></br>
          <small> {{ response.date() | date_granular }} </small> </br>
        </div>
        <div class="span10">
          <p truncateable="100">
           {{ response.display_text() | safe }} - <em><a href="/staff_card/{{uid}}" data-placement="top" data-toggle="popover" href="#" id="contactinfoPopoverResponse{{loop.index}}" class="hidden-phone hidden-tablet"><span class="contactinfoPopover" onmouseover="directoryPopover('{{staff.email}}', '{{staff.department}}', '{{staff.phone}}', '#contactinfoPopoverResponse{{loop.index}}')">{{ staff.alias or staff.email }}</span></a></em>.
         </p>
        </div>
      </div>
    {% endfor %}
  {% else %}<!--added an if then to check to see if any responses exist - if no then show text here for the "if any response exists" above -->
 <div class="span10">
  <p>There are no records uploaded just yet.  Stay tuned!</p>
  </div>
  {% endif %}
  </div>
</div>
{% endblock responses_container %}

{% block custom_script_links %}
  <link rel=stylesheet type=text/css href="{{ url_for('static', filename='css/case.css') }}">
  <script type="text/javascript" src="{{ url_for('static', filename='js/case.js') }}"></script>
=======


{% block custom_script_links %}
  <!-- Listed in case instead of manage_request_city for truncation -->
  <script type="text/javascript" src="{{ url_for('static', filename='js/manage_request_city.js') }}"></script>
  <link rel=stylesheet type=text/css href="{{ url_for('static', filename='css/manage_request_city.css') }}">

  <!-- For response_widget partial -->
  <link rel=stylesheet type=text/css href="{{ url_for('static', filename='css/_response_widget.css') }}">
  <script type="text/javascript" src="{{ url_for('static', filename='js/_response_widget.js') }}"></script>

  <!-- For sidebar styling -->
  <link rel=stylesheet type=text/css href="{{ url_for('static', filename='css/sidebar.css') }}">
  <link rel=stylesheet type=text/css href="{{ url_for('static', filename='css/bottom_sidebar.css') }}">
>>>>>>> 8ce037daba1a98982998fca89c20e5f60377921c
{% endblock custom_script_links %}
