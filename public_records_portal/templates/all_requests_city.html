<!-- This template is show all cases in the system for the city. -->

{% extends "all_requests.html" %}
{% block title %}{{title}}{% endblock title %}
{% block datatable %}
  <table cellpadding="0" cellspacing="0" border="0" id="allrequestTable" class="data-table table">
    <thead>
      <tr>
        <th class="status">Status</th>
        <th>#</th>
        <th>Received</th>
        <th>Request</th>
        <th>Department</th>
        <th>Owner</th>
        <th>Updated</th>
        <th>Due</th>
      </tr>
    </thead>
    <tbody>
      {% for request in all_record_requests %}
      {% if user_id %}
        <tr onclick="window.location.href='/city/request/{{request.id}}';">
        {% else %}
        <tr onclick="window.location.href='/request/{{request.id}}';">
        {% endif %}
          {% set status = request | get_status("city") %}
          {% set status_icon = status | get_status_icon %}
          <!-- <td>{{ status }} </td> -->
           <td class="status {{status}}"><small><i class="{{status_icon}}"></i></small>{{status}}</td>
          <td>{{ request.id }}</td>
          <td>{{ request.date_created | date }}</td>

          <td><div>{{ request.text }}</div></td>

          {% set uid = ("user_id" | get_attribute(request.current_owner, "Owner")) %}
          <td>{{ "department" | get_attribute(uid, "User") }}</td>
          <td>{{ "alias" | get_attribute(uid, "User") }}</td>
          <td>{{ request.status_updated | date_granular }} </td> 
          <td>{{ request.date_created | due_date(request.extended) }}</td>
          </a> 
        </tr>
      {% else %}
      {% endfor %}
    </tbody>
  </table>
{% endblock datatable %}

{% block sidebar %}
  <div class="well r_sidebar r_sidebar-fixed">
    <h4>View</h4>

    <form name="filterPublic" class="form-horizontal" id="filterPublic" method="post" action="/filterPublic">
      <fieldset>
        <label class="checkbox">
          <input type="checkbox" value="" checked>
            My requests
          </label>
        <label class="checkbox">
          <input type="checkbox" value="" checked>
          Open requests
        </label>
        <label class="checkbox">
          <input type="checkbox" value="">
          Due requests
        </label>
        <div class="row-fluid">
          <select class="span12 selectpicker">
            <option >All departments</option>
<!--              {% for blank in blank %}
            <option>{{"department"}}</option>
            {% endfor %} -->
          </select>
        </div>
        <div class="row-fluid">
          <div id="viewSubmit" class="span6 offset3">
            <button type="submit" class="btn btn-primary input-block-level">Update table</button>
          </div>
        </div>
      </fieldset>
    </form>
  </div>
{% endblock sidebar %}
